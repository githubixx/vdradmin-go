{{define "index.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - VDRAdmin</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="legacy-home">
    <div class="legacy-frame">
        <aside class="legacy-nav" aria-label="Navigation">
            <div class="legacy-logo">
                <a href="/" aria-label="VDRAdmin Home">VDRAdmin</a>
            </div>

            <div class="legacy-nav-bar">
                <div class="legacy-navi"><a href="/">What's On Now?</a></div>
                <div class="legacy-navi"><a href="/epg">EPG</a></div>
                <div class="legacy-navi"><a href="/timers">Timer</a></div>
                <div class="legacy-navi"><a href="/recordings">Recordings</a></div>

                <form action="/search" method="get" class="legacy-search">
                    <input type="text" name="q" aria-label="Search" />
                    <br />
                    <input type="submit" value="Search" />
                </form>

                {{if .User}}
                <div class="legacy-user">
                    <span>{{.User}}</span>
                    {{if eq .Role "admin"}}<span class="legacy-badge">Admin</span>{{end}}
                </div>
                {{end}}
            </div>
        </aside>

        <main class="legacy-main" aria-label="Main content">
            <div class="legacy-heading">
                <h2>What's On Now?</h2>
            </div>

            {{if .HomeError}}
            <div class="legacy-warning">
                <strong>VDR connection error:</strong> {{.HomeError}}
            </div>
            {{end}}

            <table class="legacy-list" role="table">
                <thead>
                    <tr class="legacy-heading-row">
                        <th scope="col">Channel</th>
                        <th scope="col">Start</th>
                        <th scope="col">End</th>
                        <th scope="col">Title</th>
                        <th scope="col">&nbsp;</th>
                    </tr>
                </thead>
                <tbody>
                    {{range $i, $e := .Events}}
                    <tr class="legacy-row">
                        <td class="legacy-col-channel">{{$e.ChannelName}}</td>
                        <td class="legacy-col-time">{{$e.Start.Format "15:04"}}</td>
                        <td class="legacy-col-time">{{$e.Stop.Format "15:04"}}</td>
                        <td class="legacy-col-title">
                            <strong>{{$e.Title}}</strong>
                            {{if $e.Subtitle}}<br /><span class="legacy-subtitle">{{$e.Subtitle}}</span>{{end}}
                        </td>
                        <td class="legacy-col-time">
                            {{if gt $e.EventID 0}}
                            <a href="/event?channel={{$e.ChannelID}}&id={{$e.EventID}}" onclick="window.open(this.href,'vdradmin_moreinfo','width=560,height=420,scrollbars=yes,resizable=yes'); return false;">More Information</a>
                            {{end}}
                        </td>
                    </tr>
                    {{else}}
                    <tr class="legacy-row">
                        <td colspan="5" class="legacy-empty">No EPG data available</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>

            <div class="legacy-footer">
                &copy; {{.Year}} vdradmin-go
            </div>
        </main>
    </div>
</body>
</html>
{{end}}
